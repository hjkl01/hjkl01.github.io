"use strict";(self.webpackChunkdocusaurus_classic_typescript=self.webpackChunkdocusaurus_classic_typescript||[]).push([[3964],{3905:(e,n,t)=>{t.d(n,{Zo:()=>d,kt:()=>m});var a=t(7294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function p(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=a.createContext({}),l=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):p(p({},n),e)),t},d=function(e){var n=l(e.components);return a.createElement(s.Provider,{value:n},e.children)},c={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},u=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),u=l(t),m=r,v=u["".concat(s,".").concat(m)]||u[m]||c[m]||o;return t?a.createElement(v,p(p({ref:n},d),{},{components:t})):a.createElement(v,p({ref:n},d))}));function m(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var o=t.length,p=new Array(o);p[0]=u;var i={};for(var s in n)hasOwnProperty.call(n,s)&&(i[s]=n[s]);i.originalType=e,i.mdxType="string"==typeof e?e:r,p[1]=i;for(var l=2;l<o;l++)p[l]=t[l];return a.createElement.apply(null,p)}return a.createElement.apply(null,t)}u.displayName="MDXCreateElement"},8062:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>p,default:()=>c,frontMatter:()=>o,metadata:()=>i,toc:()=>l});var a=t(7462),r=(t(7294),t(3905));const o={},p="django",i={unversionedId:"django",id:"django",title:"django",description:"load environment",source:"@site/notes/python/django.md",sourceDirName:".",slug:"/django",permalink:"/notes/python/django",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"database",permalink:"/notes/python/databases"},next:{title:"fastapi",permalink:"/notes/python/fastapi"}},s={},l=[{value:"load environment",id:"load-environment",level:3},{value:"auto load app",id:"auto-load-app",level:3},{value:"cors",id:"cors",level:3},{value:"static in debug mode",id:"static-in-debug-mode",level:3},{value:"dump and load data",id:"dump-and-load-data",level:3},{value:"save data with scripts",id:"save-data-with-scripts",level:3}],d={toc:l};function c(e){let{components:n,...t}=e;return(0,r.kt)("wrapper",(0,a.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"django"},"django"),(0,r.kt)("h3",{id:"load-environment"},"load environment"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'# load environment\nimport os\nenvs = os.environ\nfor k, v in envs.items():\n    print(k, v)\n\n# load .env\n# pip install django-environ\n\nimport environ\nimport os\n\nenv = environ.Env(\n    # set casting, default value\n    DEBUG=(bool, False)\n)\n\n# Set the project base directory\nBASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))\n\n# Take environment variables from .env file\nenviron.Env.read_env(os.path.join(BASE_DIR, \'.env\'))\n\n# SECURITY WARNING: don\'t run with debug turned on in production!\nDEBUG = env("DEBUG", default=True)\n\nfrom django.core.management.utils import get_random_secret_key\nSECRET_KEY = env("SECRET_KEY", default=get_random_secret_key())\n\n# database url https://pypi.org/project/dj-database-url/\n# pip install dj_database_url\n\nimport dj_database_url\n# write .env and set DATABASE_URL\nDATABASES = {\n    "default": dj_database_url.config(\n        default=env("DATABASE_URL", default="sqlite:///db.sqlite3"), conn_max_age=600, conn_health_checks=True\n    )\n}\n')),(0,r.kt)("h3",{id:"auto-load-app"},"auto load app"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'# mkdir -p apps/appname\n# django-admin startapp appname apps/appname\n# update apps/appname/apps.py\nname = "apps.appname"\n\n# settings.py\nAPPS_FLODER = os.path.join(BASE_DIR, "apps")\nAPPS = [_ for _ in os.listdir(APPS_FLODER) if os.path.isdir(os.path.join(APPS_FLODER, _)) and "pycache" not in _]\nINSTALLED_APPS += ["apps." + _ for _ in APPS]\n')),(0,r.kt)("h3",{id:"cors"},"cors"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"# pip install django-cors-headers\n\nINSTALLED_APPS = (\n    ...\n    'corsheaders',\n    ...\n)\n\nMIDDLEWARE = [\n    ...\n    'corsheaders.middleware.CorsMiddleware',\n    'django.middleware.common.CommonMiddleware',\n    ...\n]\n\nCORS_ALLOW_ALL_ORIGINS=True\n\n# Load the default ones\nCORS_ALLOWED_ORIGINS = [\"http://localhost:3000\", \"http://127.0.0.1:3000\"]\n")),(0,r.kt)("h3",{id:"static-in-debug-mode"},"static in debug mode"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"python manage.py runserver 0.0.0.0:8000 --insecure\n")),(0,r.kt)("h3",{id:"dump-and-load-data"},"dump and load data"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"python manage.py dumpdata (myapp) > myapp.json\n\npython manage.py loaddata myapp.json\n")),(0,r.kt)("h3",{id:"save-data-with-scripts"},"save data with scripts"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"import os\nimport django\nfrom proxyip.models import ProxyIP\n\nos.environ['DJANGO_SETTINGS_MODULE'] = 'dj_project.settings'\ndjango.setup()\n\np = ProxyIP(ip='192.168.50.1')\np.save()\nprint(ProxyIP.objects.all())\n\npython manage.py shell < main.py\n")))}c.isMDXComponent=!0}}]);